{
  "version": "1.11.0",
  "description": "UGREEN NAS Desktop Client for Windows",
  "homepage": "https://www.ugnas.com/download",
  "license": "Proprietary",
  "notes": [
    "UGREEN NAS Windows desktop application",
    "Requires Windows 10 or later (64-bit)"
  ],
  "url": "https://api-zh.ugnas.com/api/system/v1/ua/temp/link?appType=client&id=413#/dl.json",
  "hash": {
    "mode": "download"
  },
  "pre_install": [
    "# Get dynamic download URL from API",
    "$jsonFile = \"$dir\\dl.json\"",
    "$response = Get-Content $jsonFile | ConvertFrom-Json",
    "$downloadUrl = $response.data.linkData.tempUrl",
    "$exeFile = \"$dir\\dl.exe\"",
    "",
    "# Download the actual installer",
    "Write-Host \"Downloading UGREEN NAS installer...\"",
    "Invoke-WebRequest -Uri $downloadUrl -OutFile $exeFile -UserAgent 'Scoop/1.0'",
    "",
    "# Remove the JSON file",
    "Remove-Item $jsonFile -Force"
  ],
  "installer": {
    "script": [
      "Remove-Item \"$dir\\Uninstall*.exe\" -Force -ErrorAction SilentlyContinue",
      "Expand-7ZipArchive \"$dir\\`$PLUGINSDIR\\app-64.7z\" \"$dir\" -Removal",
      "Remove-Item \"$dir\\`$PLUGINSDIR\" -Force -Recurse -ErrorAction SilentlyContinue"
    ]
  },
  "bin": [
    [
      "UGREEN NAS.exe",
      "ugnas"
    ]
  ],
  "shortcuts": [
    [
      "UGREEN NAS.exe",
      "UGREEN NAS"
    ]
  ],
  "checkver": {
    "url": "https://api.ugnas.com/api/system/v3/sa/apk",
    "jsonpath": "$.data.appSoftVers[?(@.appNo=='com.ugreenNasPro.win' && @.clientBit==2)]",
    "regex": "verName.*?v([\\d.]+).*?\"id\":(\\d+)"
  },
  "autoupdate": {
    "url": "https://api-zh.ugnas.com/api/system/v1/ua/temp/link?appType=client&id=$match2#/dl.json",
    "hash": {
      "mode": "download"
    }
  }
}
