{
    "version": "3.4.2",
    "description": "Taskwarrior - Command line Task Management",
    "homepage": "https://taskwarrior.org/",
    "license": "MIT",
    "notes": [
        "This package builds from source using MSYS2.",
        "Prerequisites:",
        "1. Install MSYS2: scoop install msys2",
        "2. In MSYS2 terminal, install build tools:",
        "   pacman -S base-devel mingw-w64-x86_64-toolchain mingw-w64-x86_64-cmake libutil-linux-devel",
        "3. Build in MSYS2 MinGW64 environment",
        "",
        "Alternative: Use WSL for easier installation: wsl sudo apt install taskwarrior"
    ],
    "suggest": {
        "MSYS2": "main/msys2"
    },
    "architecture": {
        "64bit": {
            "url": "https://github.com/GothenburgBitFactory/taskwarrior/releases/download/v3.4.2/task-3.4.2.tar.gz",
            "hash": "d302761fcd1268e4a5a545613a2b68c61abd50c0bcaade3b3e68d728dd02e716"
        }
    },
    "extract_dir": "task-3.4.2",
    "installer": {
        "script": [
            "$ErrorActionPreference = 'Stop'",
            "$msys2 = Get-Command msys2 -ErrorAction SilentlyContinue",
            "if (-not $msys2) {",
            "    Write-Host 'Error: MSYS2 not found. Please install with: scoop install msys2' -ForegroundColor Red",
            "    exit 1",
            "}",
            "$buildScript = @'",
            "cd \"$($dir -replace '\\\\', '/')\" || exit 1",
            "cmake -S . -B build -DCMAKE_BUILD_TYPE=Release -DCMAKE_INSTALL_PREFIX=\"$($dir -replace '\\\\', '/')\" -G \"MSYS Makefiles\" || exit 1",
            "cmake --build build --config Release || exit 1",
            "cmake --install build || exit 1",
            "'@",
            "$buildScript | Out-File -FilePath \"$dir\\build.sh\" -Encoding ASCII",
            "& msys2 -c \"bash '$($dir -replace '\\\\', '/')/build.sh'\"",
            "if ($LASTEXITCODE -ne 0) {",
            "    Write-Host 'Build failed. Make sure you have installed the required packages in MSYS2:' -ForegroundColor Red",
            "    Write-Host 'pacman -S base-devel mingw-w64-x86_64-toolchain mingw-w64-x86_64-cmake libutil-linux-devel' -ForegroundColor Yellow",
            "    exit 1",
            "}"
        ]
    },
    "bin": "bin\\task.exe",
    "checkver": {
        "github": "https://github.com/GothenburgBitFactory/taskwarrior"
    },
    "autoupdate": {
        "architecture": {
            "64bit": {
                "url": "https://github.com/GothenburgBitFactory/taskwarrior/releases/download/v$version/task-$version.tar.gz"
            }
        },
        "extract_dir": "task-$version"
    }
}
