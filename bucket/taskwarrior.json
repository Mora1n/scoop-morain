{
    "version": "3.4.2",
    "description": "Taskwarrior - Command line Task Management",
    "homepage": "https://taskwarrior.org/",
    "license": "MIT",
    "notes": [
        "This package builds from source and requires:",
        "1. CMake and MinGW: scoop install cmake mingw",
        "2. MSYS2 with libuuid: Install MSYS2 and run: pacman -S mingw-w64-x86_64-libuuid",
        "3. Add MSYS2 MinGW64 bin to PATH before installation",
        "",
        "Alternative: Use WSL for easier installation: wsl sudo apt install taskwarrior"
    ],
    "suggest": {
        "CMake": "main/cmake",
        "MinGW": "main/mingw",
        "MSYS2": "main/msys2"
    },
    "architecture": {
        "64bit": {
            "url": "https://github.com/GothenburgBitFactory/taskwarrior/releases/download/v3.4.2/task-3.4.2.tar.gz",
            "hash": "d302761fcd1268e4a5a545613a2b68c61abd50c0bcaade3b3e68d728dd02e716"
        }
    },
    "extract_dir": "task-3.4.2",
    "pre_install": [
        "if (!(Test-Path env:MSYSTEM)) {",
        "    Write-Host 'Warning: MSYS2 environment not detected. Please install MSYS2 and libuuid.' -ForegroundColor Yellow",
        "    Write-Host 'Run: pacman -S mingw-w64-x86_64-libuuid' -ForegroundColor Yellow",
        "}"
    ],
    "installer": {
        "script": [
            "$ErrorActionPreference = 'Stop'",
            "Push-Location \"$dir\"",
            "try {",
            "    cmake -S . -B build -DCMAKE_BUILD_TYPE=Release -DCMAKE_INSTALL_PREFIX=\"$dir\" -G \"MinGW Makefiles\" 2>&1 | Tee-Object -Variable output",
            "    if ($LASTEXITCODE -ne 0) {",
            "        Write-Host 'CMake configuration failed. Make sure libuuid is installed in MSYS2.' -ForegroundColor Red",
            "        throw 'CMake failed'",
            "    }",
            "    cmake --build build --config Release",
            "    if ($LASTEXITCODE -ne 0) { throw 'Build failed' }",
            "    cmake --install build",
            "    if ($LASTEXITCODE -ne 0) { throw 'Install failed' }",
            "} catch {",
            "    Write-Host \"Build failed: $_\" -ForegroundColor Red",
            "    Write-Host 'Please ensure MSYS2 is installed with: pacman -S mingw-w64-x86_64-libuuid' -ForegroundColor Yellow",
            "    exit 1",
            "} finally {",
            "    Pop-Location",
            "}"
        ]
    },
    "bin": "bin\\task.exe",
    "checkver": {
        "github": "https://github.com/GothenburgBitFactory/taskwarrior"
    },
    "autoupdate": {
        "architecture": {
            "64bit": {
                "url": "https://github.com/GothenburgBitFactory/taskwarrior/releases/download/v$version/task-$version.tar.gz"
            }
        },
        "extract_dir": "task-$version"
    }
}
